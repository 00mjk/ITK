#
# Default rules for making dashboards from a site
#

XALAN = $(topdir)/Code/Insight3DParty/xalan/xalan.jar
XMLHEADER = <?xml version="1.0" encoding="UTF-8"?>


TARGETS = Build.html Test.html Coverage.html BuildSummary.xml TestSummary.xml SummaryByTest.xml CoverageSummary.xml

# BuildStampRules
all: $(TARGETS) 

Update: all

clean:
	$(RM) $(TARGETS)

Build.html: XML/Build.xml $(topdir)/Testing/Utilities/XSL/Build.xsl
	$(JAVA) -jar $(XALAN) -Q -OUT $@ -IN $< -XSL $(topdir)/Testing/Utilities/XSL/Build.xsl

Test.html: XML/Test.xml $(topdir)/Testing/Utilities/XSL/Test.xsl
	$(JAVA) -jar $(XALAN) -Q -OUT $@ -IN $< -XSL $(topdir)/Testing/Utilities/XSL/Test.xsl

Coverage.html: XML/Coverage.xml $(topdir)/Testing/Utilities/XSL/Coverage.xsl
	$(JAVA) -jar $(XALAN) -Q -OUT $@ -IN $< -XSL $(topdir)/Testing/Utilities/XSL/Coverage.xsl

BuildSummary.xml: XML/Build.xml $(topdir)/Testing/Utilities/XSL/BuildSummary.xsl
	$(JAVA) -jar $(XALAN) -Q -OUT $@ -IN $< -XSL $(topdir)/Testing/Utilities/XSL/BuildSummary.xsl

TestSummary.xml: XML/Test.xml $(topdir)/Testing/Utilities/XSL/TestSummary.xsl
	$(JAVA) -jar $(XALAN) -Q -OUT $@ -IN $< -XSL $(topdir)/Testing/Utilities/XSL/TestSummary.xsl

SummaryByTest.xml: XML/Test.xml $(topdir)/Testing/Utilities/XSL/SummaryByTest.xsl
	$(JAVA) -jar $(XALAN) -Q -OUT $@ -IN $< -XSL $(topdir)/Testing/Utilities/XSL/SummaryByTest.xsl

CoverageSummary.xml: XML/Coverage.xml $(topdir)/Testing/Utilities/XSL/CoverageSummary.xsl
	$(JAVA) -jar $(XALAN) -Q -OUT $@ -IN $< -XSL $(topdir)/Testing/Utilities/XSL/CoverageSummary.xsl



# Dummy rule to stop nasty warnings
XML/Coverage.xml:
	echo '$(XMLHEADER)' >  XML/Coverage.xml
	echo '<Coverage></Coverage>' >> XML/Coverage.xml